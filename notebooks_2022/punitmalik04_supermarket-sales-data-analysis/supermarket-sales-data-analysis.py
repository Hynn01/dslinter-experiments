#!/usr/bin/env python
# coding: utf-8

# In[ ]:


import numpy as np 
import pandas as pd
import matplotlib.pyplot as plt


supermarket_data = pd.read_csv('/kaggle/input/supermarket-sales/supermarket_sales - Sheet1.csv')
supermarket_data


# In[ ]:



supermarket_data.info()


# In[ ]:


#deleting  columns including invoice ID, date, time and gross margin percentage
supermarket_data = supermarket_data.drop(['Invoice ID','Time','Date','gross margin percentage','Tax 5%'],axis =1)
supermarket_data.rename(columns={'Product line':'Product_line', 'gross income':'gross_income'}, inplace=True)


# In[ ]:


#comparing the performance of three branches from the ratings given to each of them.
branch_data = supermarket_data.groupby('Branch')
branch_A = branch_data.get_group('A')
branch_B = branch_data.get_group('B')
branch_C = branch_data.get_group('C')

print('Calculating the mean of Ratings of three branches')

print('mean of A' , branch_A['Rating'].mean() ,
      '\nmean of B', branch_B['Rating'].mean() ,
      '\nmean of C', branch_C['Rating'].mean())
  


# In[ ]:


print('Calculating the mean of gross income of three branches')
print('mean of A' , branch_A['gross_income'].mean() ,
      '\nmean of B', branch_B['gross_income'].mean() ,
      '\nmean of C', branch_C['gross_income'].mean())


# In[ ]:


profitability = (supermarket_data['gross_income'].mean()/supermarket_data['cogs'].mean())*100

profitability


# In[ ]:


profit_A = (branch_A['gross_income'].mean()/branch_A['cogs'].mean())*100
profit_B = (branch_B['gross_income'].mean()/branch_B['cogs'].mean())*100
profit_C = (branch_C['gross_income'].mean()/branch_C['cogs'].mean())*100

print('\n ',profit_A,'\n ',profit_B,'\n ',profit_C)


# In[ ]:


product_type= supermarket_data['Product_line'].unique()
product_type


# In[ ]:





# In[ ]:


#comparing income generated by different category of product line. 
def profit(column1,column2,category):  #created a function which takes three arguments i.e. two columns and one category from column 1 within the first column.

    df_data = pd.DataFrame()  #empty dataframe

    for i in category:
            product_sum = supermarket_data.groupby(column1).get_group(i)
            series_data = pd.Series(product_sum[column2].mean())
            df_data = df_data.append(series_data,ignore_index=True)

    plt.bar(category,df_data[0],width = 0.6)
    plt.xticks(rotation=45)
    plt.show()
    
profit('Product_line','gross_income',product_type)


# In[ ]:


profit(supermarket_data['Gender'],'gross_income',supermarket_data['Gender'].unique())


# In[ ]:


profit(supermarket_data['Customer type'],'gross_income',supermarket_data['Customer type'].unique())
profit(supermarket_data['City'],'gross_income',supermarket_data['City'].unique())
profit(supermarket_data['Payment'],'gross_income',supermarket_data['Payment'].unique())


# In[ ]:


supermarket_data.describe()

